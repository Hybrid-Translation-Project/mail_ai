{% extends "base.html" %}

{% block extra_css %}
    <link rel="stylesheet" href="/static/css/editor.css">
{% endblock %}

{% block content %}
<a href="/ui" class="btn btn-sm" style="background:#333; margin-bottom: 20px; color: white; text-decoration: none; padding: 5px 15px; border-radius: 4px; display: inline-block;">
    â† Listeye DÃ¶n
</a>

<div class="row" style="display: flex; gap: 20px; align-items: flex-start;">
    <div class="col-md-7" style="flex: 2;">
        <div class="mail-card" style="background: #1e1e1e; padding: 20px; border-radius: 8px; border: 1px solid #333;">
            <h3 style="margin-top:0; color: #fff;">ğŸ“© Gelen Mail</h3>
            <p style="color: #bbb;"><strong>Kimden:</strong> {{ mail.from }}</p>
            <p style="color: #bbb;"><strong>Konu:</strong> {{ mail.subject }}</p>
            <hr style="border-color: #333;">
            <div style="white-space: pre-wrap; color: #eee; line-height: 1.6;">{{ mail.body }}</div>
        </div>
    </div>

    <div class="col-md-5" style="flex: 1.5;">
        <div class="mail-card" style="background: #1e1e1e; padding: 20px; border-radius: 8px; border: 1px solid #333; position: sticky; top: 20px;">
            
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin: 0; color: #fff;">ğŸ¤– AI Cevap Paneli</h3>
                
                <button type="button" onclick="handleAction('regenerate', '{{ mail._id }}')" class="btn" title="AI TaslaÄŸÄ±nÄ± Yenile" style="background: #444; color: #fff; border: none; padding: 5px 10px; cursor: pointer; border-radius: 4px; font-size: 0.85rem;">
                    ğŸ”„ Yeniden OluÅŸtur
                </button>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 15px;">
                <button type="button" onclick="handleAction('approve', '{{ mail._id }}')" class="btn" style="background: #155724; color: #d4edda; border: 1px solid #1e7e34; padding: 10px; border-radius: 4px; cursor: pointer; font-weight: 500;">
                    âœ… Kabul Et
                </button>
                <button type="button" onclick="handleAction('reject', '{{ mail._id }}')" class="btn" style="background: #721c24; color: #f8d7da; border: 1px solid #bd2130; padding: 10px; border-radius: 4px; cursor: pointer; font-weight: 500;">
                    âŒ Reddet
                </button>
            </div>

            <form action="/ui/update/{{ mail._id }}" method="post" id="replyForm">
                <textarea name="reply_draft" rows="12" style="width: 100%; background: #252525; color: #fff; border: 1px solid #444; border-radius: 4px; padding: 10px; font-family: inherit; font-size: 1rem; resize: vertical;">{{ mail.reply_draft }}</textarea>
                
                <div style="margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <button type="submit" class="btn" style="background: #007bff; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer; font-weight: 500;">
                        ğŸ’¾ TaslaÄŸÄ± Kaydet
                    </button>
                    
                    <button type="submit" formaction="/ui/approve/{{ mail._id }}" class="btn" style="background: #28a745; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer; font-weight: 500;">
                        ğŸš€ Onayla ve GÃ¶nder
                    </button>
                    
                    <button type="submit" formaction="/ui/cancel/{{ mail._id }}" class="btn" style="background: #dc3545; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer; grid-column: span 2; font-weight: 500;">
                        ğŸš« Bu Maili ArÅŸive At
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script src="/static/js/editor.js"></script>
{% endblock %}